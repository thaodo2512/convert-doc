{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Numeric Sensor PDR (DSP0248 Type 2)",
  "description": "Per DSP0248 v1.3.0 Clause 28.4 and DSP0240 v1.2.0 Section 2.5",
  "type": "object",
  "additionalProperties": false,
  "binaryOrder": [
    "pdrHeader",
    "PLDMTerminusHandle",
    "sensorID",
    "entityType",
    "entityInstanceNumber",
    "containerID",
    "sensorInit",
    "hysteresisSupport",
    "thresholdSupport",
    "eventMessageEnable",
    "sensorDataSize",
    "resolution",
    "offset",
    "accuracy",
    "plusTolerance",
    "minusTolerance",
    "hysteresis",
    "lowerThresholdNonCritical",
    "lowerThresholdCritical",
    "lowerThresholdFatal",
    "upperThresholdNonCritical",
    "upperThresholdCritical",
    "upperThresholdFatal",
    "maxReadable",
    "minReadable",
    "rangeFieldFormat",
    "rangeFieldSupport",
    "nominalValue",
    "normalMax",
    "normalMin",
    "ratedMax",
    "ratedMin",
    "baseUnit",
    "unitModifier",
    "rateUnit",
    "baseOEMUnitHandle",
    "auxUnit",
    "auxUnitModifier",
    "auxRateUnit",
    "rel",
    "auxOEMUnitHandle",
    "isLinear"
  ],
  "x-c-struct-packing": 1,
  "properties": {
    "pdrHeader": {
      "type": "object",
      "description": "Common PDR Header (DSP0248)",
      "additionalProperties": false,
      "binaryOrder": [
        "recordHandle",
        "PDRHeaderVersion",
        "PDRType",
        "recordChangeNumber",
        "dataLength"
      ],
      "properties": {
        "recordHandle": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "auto"
              ]
            },
            {
              "type": "integer",
              "minimum": 0,
              "maximum": 4294967295
            }
          ],
          "binaryFormat": "I",
          "description": "uint32; PDR Record Handle. 0 = auto-assign."
        },
        "PDRHeaderVersion": {
          "type": "integer",
          "const": 1,
          "binaryFormat": "B",
          "description": "uint8; PDR Header Version (1)"
        },
        "PDRType": {
          "type": "integer",
          "const": 2,
          "binaryFormat": "B",
          "description": "uint8; PDR Type 2 = Numeric Sensor"
        },
        "recordChangeNumber": {
          "type": "integer",
          "default": 0,
          "binaryFormat": "H",
          "description": "uint16; recordChangeNumber"
        },
        "dataLength": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "auto"
              ]
            },
            {
              "type": "integer",
              "minimum": 0
            }
          ],
          "binaryFormat": "H",
          "description": "uint16; Length of data following this header (calculated automatically)."
        }
      },
      "required": [
        "recordHandle",
        "PDRHeaderVersion",
        "PDRType",
        "recordChangeNumber",
        "dataLength"
      ]
    },
    "PLDMTerminusHandle": {
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "binaryFormat": "H",
      "description": "uint16; PLDM Terminus Handle"
    },
    "sensorID": {
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "binaryFormat": "H",
      "description": "uint16; Sensor ID"
    },
    "entityType": {
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "binaryFormat": "H",
      "description": "uint16; Entity Type"
    },
    "entityInstanceNumber": {
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "binaryFormat": "H",
      "description": "uint16; Entity Instance Number"
    },
    "containerID": {
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "binaryFormat": "H",
      "description": "uint16; Container ID"
    },
    "sensorInit": {
      "type": "integer",
      "minimum": 0,
      "maximum": 3,
      "binaryFormat": "B",
      "description": "uint8; Sensor Initialization: 0=noInit, 1=useInitPDR, 2=enableSensor, 3=enableAndInitSensor"
    },
    "hysteresisSupport": {
      "type": "integer",
      "minimum": 0,
      "maximum": 3,
      "binaryFormat": "B",
      "description": "uint8; Hysteresis Support: 0=none, 1=readable, 2=readableAndSettable, 3=fixedUnreadable"
    },
    "thresholdSupport": {
      "type": "integer",
      "minimum": 0,
      "maximum": 3,
      "binaryFormat": "B",
      "description": "uint8; Threshold Support: 0=none, 1=readable, 2=readableAndSettable, 3=fixedUnreadable"
    },
    "eventMessageEnable": {
      "type": "integer",
      "minimum": 0,
      "maximum": 3,
      "binaryFormat": "B",
      "description": "uint8; Event Message Enable: 0=noEventGeneration, 1=eventsOnly, 2=sensorOpStateOnly, 3=eventsAndSensorOpState"
    },
    "sensorDataSize": {
      "type": "integer",
      "minimum": 1,
      "maximum": 7,
      "binaryFormat": "B",
      "description": "uint8; Sensor Data Size: 1=uint8, 2=sint8, 3=uint16, 4=sint16, 5=uint32, 6=sint32, 7=real32"
    },
    "resolution": {
      "type": "number",
      "binaryFormat": "f",
      "description": "real32; Resolution"
    },
    "offset": {
      "type": "number",
      "binaryFormat": "f",
      "description": "real32; Offset"
    },
    "accuracy": {
      "type": "integer",
      "minimum": 0,
      "maximum": 999999,
      "binaryFormat": "H",
      "description": "uint16; Accuracy (x 1e-6)"
    },
    "plusTolerance": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Plus Tolerance (x 0.001 * accuracy)"
    },
    "minusTolerance": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Minus Tolerance (x 0.001 * accuracy)"
    },
    "hysteresis": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Hysteresis value, format per sensorDataSize"
    },
    "lowerThresholdNonCritical": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Lower Non-Critical Threshold, format per sensorDataSize"
    },
    "lowerThresholdCritical": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Lower Critical Threshold, format per sensorDataSize"
    },
    "lowerThresholdFatal": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Lower Fatal Threshold, format per sensorDataSize"
    },
    "upperThresholdNonCritical": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Upper Non-Critical Threshold, format per sensorDataSize"
    },
    "upperThresholdCritical": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Upper Critical Threshold, format per sensorDataSize"
    },
    "upperThresholdFatal": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Upper Fatal Threshold, format per sensorDataSize"
    },
    "maxReadable": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Max Readable, format per sensorDataSize"
    },
    "minReadable": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "sensorDataSize",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Min Readable, format per sensorDataSize"
    },
    "rangeFieldFormat": {
      "type": "integer",
      "minimum": 1,
      "maximum": 7,
      "binaryFormat": "B",
      "description": "uint8; Range Field Format, same codes as sensorDataSize"
    },
    "rangeFieldSupport": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "bitfield8; Support for range fields (bits 0-4: nominal, normalMax, normalMin, ratedMax, ratedMin)"
    },
    "nominalValue": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "rangeFieldFormat",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Nominal Value, format per rangeFieldFormat"
    },
    "normalMax": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "rangeFieldFormat",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Normal Max, format per rangeFieldFormat"
    },
    "normalMin": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "rangeFieldFormat",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Normal Min, format per rangeFieldFormat"
    },
    "ratedMax": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "rangeFieldFormat",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Rated Max, format per rangeFieldFormat"
    },
    "ratedMin": {
      "type": "number",
      "binaryFormat": "variable",
      "x-binary-type-field": "rangeFieldFormat",
      "x-binary-type-mapping": {
        "1": "B",
        "2": "b",
        "3": "H",
        "4": "h",
        "5": "I",
        "6": "i",
        "7": "f"
      },
      "description": "Rated Min, format per rangeFieldFormat"
    },
    "baseUnit": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Base Unit"
    },
    "unitModifier": {
      "type": "integer",
      "minimum": -128,
      "maximum": 127,
      "binaryFormat": "b",
      "description": "sint8; Unit Modifier"
    },
    "rateUnit": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Rate Unit"
    },
    "baseOEMUnitHandle": {
      "type": "integer",
      "minimum": 0,
      "maximum": 4294967295,
      "binaryFormat": "I",
      "description": "uint32; Base OEM Unit Handle"
    },
    "auxUnit": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Aux Unit"
    },
    "auxUnitModifier": {
      "type": "integer",
      "minimum": -128,
      "maximum": 127,
      "binaryFormat": "b",
      "description": "sint8; Aux Unit Modifier"
    },
    "auxRateUnit": {
      "type": "integer",
      "minimum": 0,
      "maximum": 255,
      "binaryFormat": "B",
      "description": "uint8; Aux Rate Unit"
    },
    "rel": {
      "type": "integer",
      "minimum": 0,
      "maximum": 1,
      "binaryFormat": "B",
      "description": "uint8; Relative: 0=aux independent, 1=aux relative to base"
    },
    "auxOEMUnitHandle": {
      "type": "integer",
      "minimum": 0,
      "maximum": 4294967295,
      "binaryFormat": "I",
      "description": "uint32; Aux OEM Unit Handle"
    },
    "isLinear": {
      "type": "integer",
      "minimum": 0,
      "maximum": 0,
      "binaryFormat": "B",
      "description": "uint8; Is Linear: 0=linear, others reserved"
    }
  },
  "required": [
    "pdrHeader",
    "PLDMTerminusHandle",
    "sensorID",
    "entityType",
    "entityInstanceNumber",
    "containerID",
    "sensorInit",
    "hysteresisSupport",
    "thresholdSupport",
    "eventMessageEnable",
    "sensorDataSize",
    "resolution",
    "offset",
    "accuracy",
    "plusTolerance",
    "minusTolerance",
    "hysteresis",
    "lowerThresholdNonCritical",
    "lowerThresholdCritical",
    "lowerThresholdFatal",
    "upperThresholdNonCritical",
    "upperThresholdCritical",
    "upperThresholdFatal",
    "maxReadable",
    "minReadable",
    "rangeFieldFormat",
    "rangeFieldSupport",
    "nominalValue",
    "normalMax",
    "normalMin",
    "ratedMax",
    "ratedMin",
    "baseUnit",
    "unitModifier",
    "rateUnit",
    "baseOEMUnitHandle",
    "auxUnit",
    "auxUnitModifier",
    "auxRateUnit",
    "rel",
    "auxOEMUnitHandle",
    "isLinear"
  ]
}
